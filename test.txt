import os

def update_environment_properties_file(cycle_id, url):
    properties_file_path = os.path.join("allure", "results", "environment.properties")
    with open(properties_file_path, "w") as properties_file:
        properties_file.write(f"CycleID={cycle_id}\n")
        properties_file.write(f"URL={url}\n")

def after_all(context):
    if context.failed:
        update_environment_properties_file("N/A", "N/A")
    else:
        # Get the cycle ID and URL from somewhere in your context
        cycle_id = context.cycle_id
        url = context.url

        # Update environment.properties file
        update_environment_properties_file(cycle_id, url)
