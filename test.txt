# Function to create a test case in JIRA with Zephyr under a specific component
def create_test_case(project_key, component_id, summary, description, labels):
    # Create issue payload
    issue_payload = {
        "fields": {
            "project": {"key": project_key},
            "summary": summary,
            "description": description,
            "issuetype": {"name": "Test"},
            "labels": labels,
            "components": [{"id": component_id}]
        }
    }

    # Create test case in JIRA
    create_issue_url = f"{jira_base_url}/issue"
    response = requests.post(
        create_issue_url,
        auth=(username, password),
        headers={"Content-Type": "application/json"},
        data=json.dumps(issue_payload),
    )

    if response.status_code == 201:
        issue_key = response.json()["key"]
        print(f"Test case created successfully. Key: {issue_key}")

        # Add the test case to Zephyr
        add_to_zephyr_url = f"{zephyr_base_url}/executions/addTestsToCycle"
        add_to_zephyr_payload = {
            "issues": [issue_key],
            "versionId": -1,  # -1 for the latest version
            "cycleId": "your_cycle_id",  # Replace with your Zephyr cycle ID
        }

        response = requests.post(
            add_to_zephyr_url,
            auth=(username, password),
            headers={"Content-Type": "application/json"},
            data=json.dumps(add_to_zephyr_payload),
        )

        if response.status_code == 200:
            print("Test case added to Zephyr successfully.")
        else:
            print("Failed to add the test case to Zephyr.")
    else:
        print("Failed to create the test case in JIRA.")
